<script lang="ts">
	let visible = $state(false);

	let el: HTMLElement;

	$effect(() => {
		const observer = new IntersectionObserver(
			(entries) => {
				const entry = entries[0];
				if (entry.intersectionRatio >= 0.5) {
					//när 50% av elementet syns kör det här blocket
					visible = true;
				} else {
					//när 50% av elemente inte längre syns KÖR DETTA.
					visible = false;
				}
			},
			{ threshold: 0.5 }
		);

		//kolla ifall elementet finns?
		if (!el) return;

		//börja observer elementet
		observer.observe(el);

		return () => {
			//sluta observera när vi dismountar
			observer.disconnect();
		};
	});
</script>

<footer bind:this={el}>
	<div class="footer-wrapper">
		<div class="footer-container">
			<svg
				xmlns="http://www.w3.org/2000/svg"
				width="100%"
				viewBox="0 0 1236 199"
				fill="none"
			>
				<path
					d="M171.944 132.504C169.654 143.397 164.986 153.85 157.941 163.864C151.071 173.703 141.824 181.785 130.199 188.109C118.75 194.434 105.275 197.597 89.775 197.597C72.3372 197.597 56.9251 193.644 43.5385 185.738C30.152 177.656 19.6717 166.236 12.0978 151.478C4.69995 136.545 1.00104 119.064 1.00104 99.0353C1.00104 79.1825 4.69995 61.8772 12.0978 47.1193C19.6717 32.3614 30.152 21.0295 43.5385 13.1235C56.9251 5.04186 72.3372 1.00102 89.775 1.00102C103.69 1.00102 116.02 3.63635 126.764 8.90701C137.685 14.002 146.58 20.5025 153.449 28.4084C160.495 36.3144 165.515 44.5718 168.509 53.1806L140.239 59.5054C136.364 49.4911 130.111 41.3216 121.48 34.9968C112.849 28.4963 102.281 25.2461 89.775 25.2461C71.6327 25.2461 57.1893 31.8344 46.4448 45.011C35.8765 58.012 30.5923 76.0201 30.5923 99.0353C30.5923 122.402 35.8765 140.674 46.4448 153.85C57.0132 166.851 71.4565 173.352 89.775 173.352C104.394 173.352 116.108 169.047 124.915 160.439C133.722 151.83 139.71 141.025 142.881 128.024L171.944 132.504ZM210.372 75.3173H211.428C215.127 68.2898 220.588 62.4921 227.809 57.9242C235.031 53.3563 243.398 51.0723 252.909 51.0723C257.312 51.0723 261.452 51.5115 265.327 52.39V78.2162C260.395 77.5135 255.815 77.1621 251.588 77.1621C239.434 77.1621 229.747 80.588 222.525 87.4399C215.303 94.116 211.693 104.833 211.693 119.591V193.38H184.743V54.2347H210.372V75.3173ZM392.196 152.796C388.321 164.919 381.276 175.284 371.06 183.893C360.844 192.326 346.4 196.543 327.729 196.543C314.871 196.543 303.422 193.556 293.382 187.582C283.519 181.433 275.857 172.912 270.396 162.02C264.936 150.951 262.206 138.302 262.206 124.071C262.206 109.664 264.848 96.927 270.132 85.8587C275.592 74.7903 283.166 66.2694 292.854 60.296C302.718 54.1469 314.255 51.0723 327.465 51.0723C340.323 51.0723 351.684 53.9712 361.548 59.7689C371.588 65.3909 379.338 73.5604 384.798 84.2775C390.435 94.8188 393.253 107.381 393.253 121.963C393.253 125.652 393.165 128.463 392.989 130.396H289.419C289.772 143.397 293.382 154.026 300.252 162.283C307.297 170.541 316.457 174.669 327.729 174.669C338.474 174.669 346.752 172.21 352.565 167.29C358.378 162.195 362.517 156.31 364.983 149.634L392.196 152.796ZM327.465 72.9455C316.545 72.9455 307.826 76.5472 301.309 83.7504C294.968 90.7779 291.181 99.4745 289.948 109.84H365.775C364.542 99.2989 360.667 90.5144 354.15 83.4869C347.633 76.4593 338.738 72.9455 327.465 72.9455ZM494.804 193.38C493.571 192.15 492.514 189.866 491.633 186.528C490.929 183.19 490.577 179.325 490.577 174.933C486.349 182.136 479.744 187.582 470.761 191.272C461.954 194.786 452.883 196.543 443.548 196.543C435.269 196.543 427.607 194.874 420.561 191.535C413.516 188.022 407.879 183.19 403.652 177.041C399.601 170.716 397.575 163.337 397.575 154.904C397.575 140.674 402.507 130.22 412.371 123.544C422.235 116.692 437.118 112.212 457.022 110.104C469.88 108.874 478.599 107.029 483.179 104.57C487.934 102.11 490.312 98.5961 490.312 94.0282C490.312 80.1488 480.537 73.2091 460.985 73.2091C453.411 73.2091 446.542 75.2295 440.377 79.2703C434.212 83.1355 429.897 88.9332 427.431 96.6635L402.859 90.8658C405.854 78.5676 412.723 68.9047 423.468 61.8772C434.212 54.6739 447.07 51.0723 462.042 51.0723C481.065 51.0723 494.98 55.0253 503.787 62.9313C512.77 70.6616 517.262 80.8515 517.262 93.5011V163.337C517.262 172.122 517.438 178.622 517.79 182.839C518.318 186.88 519.375 190.393 520.961 193.38H494.804ZM490.312 121.699C488.375 123.807 484.236 125.564 477.895 126.97C471.73 128.2 463.803 129.429 454.116 130.659C445.837 131.713 438.88 134.261 433.243 138.302C427.783 142.167 425.053 147.701 425.053 154.904C425.053 161.58 427.167 166.675 431.394 170.189C435.621 173.527 441.434 175.196 448.832 175.196C455.525 175.196 462.042 173.967 468.383 171.507C474.724 168.872 479.92 164.831 483.971 159.384C488.199 153.762 490.312 146.823 490.312 138.565V121.699ZM601.843 170.189V193.38C597.968 193.732 591.363 193.907 582.028 193.907C568.993 193.907 559.658 191.799 554.022 187.582C548.561 183.366 545.831 175.284 545.831 163.337V74.5267H522.845V54.2347H545.831V14.9683H572.78V54.2347H603.429V74.5267H572.78V156.222C572.78 162.371 573.925 166.324 576.215 168.081C578.505 169.838 582.644 170.716 588.633 170.716L601.843 170.189ZM731.332 152.796C727.457 164.919 720.411 175.284 710.195 183.893C699.979 192.326 685.536 196.543 666.865 196.543C654.007 196.543 642.558 193.556 632.518 187.582C622.654 181.433 614.992 172.912 609.532 162.02C604.072 150.951 601.342 138.302 601.342 124.071C601.342 109.664 603.984 96.927 609.268 85.8587C614.728 74.7903 622.302 66.2694 631.99 60.296C641.854 54.1469 653.391 51.0723 666.601 51.0723C679.459 51.0723 690.82 53.9712 700.684 59.7689C710.724 65.3909 718.474 73.5604 723.934 84.2775C729.571 94.8188 732.389 107.381 732.389 121.963C732.389 125.652 732.301 128.463 732.125 130.396H628.555C628.907 143.397 632.518 154.026 639.388 162.283C646.433 170.541 655.592 174.669 666.865 174.669C677.61 174.669 685.888 172.21 691.701 167.29C697.513 162.195 701.653 156.31 704.119 149.634L731.332 152.796ZM666.601 72.9455C655.68 72.9455 646.962 76.5472 640.445 83.7504C634.104 90.7779 630.316 99.4745 629.083 109.84H704.911C703.678 99.2989 699.803 90.5144 693.286 83.4869C686.769 76.4593 677.874 72.9455 666.601 72.9455ZM852.699 47.1193H851.642L816.238 193.38H782.683L734.597 5.21754H764.453L799.064 155.168H800.121L835.789 5.21754H868.023L903.691 155.168H904.747L939.623 5.21754H969.743L921.128 193.38H888.631L852.699 47.1193ZM1087.55 152.796C1083.67 164.919 1076.63 175.284 1066.41 183.893C1056.2 192.326 1041.75 196.543 1023.08 196.543C1010.22 196.543 998.775 193.556 988.735 187.582C978.871 181.433 971.209 172.912 965.749 162.02C960.288 150.951 957.558 138.302 957.558 124.071C957.558 109.664 960.2 96.927 965.484 85.8587C970.945 74.7903 978.519 66.2694 988.206 60.296C998.07 54.1469 1009.61 51.0723 1022.82 51.0723C1035.68 51.0723 1047.04 53.9712 1056.9 59.7689C1066.94 65.3909 1074.69 73.5604 1080.15 84.2775C1085.79 94.8188 1088.61 107.381 1088.61 121.963C1088.61 125.652 1088.52 128.463 1088.34 130.396H984.772C985.124 143.397 988.735 154.026 995.604 162.283C1002.65 170.541 1011.81 174.669 1023.08 174.669C1033.83 174.669 1042.1 172.21 1047.92 167.29C1053.73 162.195 1057.87 156.31 1060.34 149.634L1087.55 152.796ZM1022.82 72.9455C1011.9 72.9455 1003.18 76.5472 996.661 83.7504C990.32 90.7779 986.533 99.4745 985.3 109.84H1061.13C1059.89 99.2989 1056.02 90.5144 1049.5 83.4869C1042.99 76.4593 1034.09 72.9455 1022.82 72.9455ZM1170.87 51.0723C1183.2 51.0723 1194.12 54.1469 1203.63 60.296C1213.32 66.2694 1220.8 74.7903 1226.09 85.8587C1231.55 96.7514 1234.28 109.401 1234.28 123.807C1234.28 138.214 1231.55 150.951 1226.09 162.02C1220.8 172.912 1213.32 181.433 1203.63 187.582C1194.12 193.556 1183.2 196.543 1170.87 196.543C1161.01 196.543 1152.2 194.698 1144.45 191.008C1136.87 187.143 1131.24 181.96 1127.54 175.46H1126.48V193.38H1100.85V2.58222H1127.8V70.5737H1128.86C1132.74 64.6003 1138.28 59.8567 1145.51 56.343C1152.9 52.8292 1161.36 51.0723 1170.87 51.0723ZM1166.11 174.669C1178.62 174.669 1188.48 170.189 1195.7 161.229C1203.1 152.093 1206.8 139.619 1206.8 123.807C1206.8 107.995 1203.1 95.6094 1195.7 86.6493C1188.48 77.5134 1178.62 72.9455 1166.11 72.9455C1153.96 72.9455 1144.18 77.5134 1136.79 86.6493C1129.56 95.7851 1125.95 108.171 1125.95 123.807C1125.95 139.444 1129.56 151.83 1136.79 160.966C1144.18 170.101 1153.96 174.669 1166.11 174.669Z"
					stroke="var(--border-color)"
					stroke-width="1"
					class:dash-anim={visible}
				/>
			</svg>
		</div>
		<div class="stripe-container monochrome-striped-background"></div>
		<div class="bottom-container">
			<p class="subheading">&copy; Createweb 2025</p>
			<p class="subheading email">
				<a class="link-monospace" href="mailto:hej@createweb.se"
					>hej@createweb.se</a
				>
			</p>
			<p class="subheading">
				<a class="link-monospace" href="/integritetspolicy"
					>Integritetspolicy</a
				>
			</p>
		</div>
	</div>
</footer>

<style lang="scss">
	footer {
		height: fit-content;
		background-color: var(--bg-color);
		border-top: 1px solid var(--border-color);
		display: grid;
		grid-template-columns: 1fr 81.125rem 1fr;
		grid-template-areas: "gutter-1 footer gutter-2";

		@media (max-width: 768px) {
			grid-template-columns: 1fr calc(100% - 4rem) 1fr;
		}

		.footer-wrapper {
			grid-area: footer;
			border-left: 1px solid var(--border-color);
			border-right: 1px solid var(--border-color);
			display: flex;
			flex-direction: column;

			.footer-container {
				height: 16rem;
				overflow: hidden;
				position: relative;

				svg {
					width: 100%;
					position: absolute;
					bottom: -3rem;
					left: 50%;
					transform: translateX(-50%);

					path {
						stroke-dasharray: 1500;
						stroke-dashoffset: 1500;

						&.dash-anim {
							animation: dash 4s ease forwards;
						}
					}

					@keyframes dash {
						100% {
							stroke-dashoffset: 0;
						}
					}
				}
			}

			.stripe-container {
				border-top: 1px solid var(--border-color);
				height: 3rem;
			}

			.bottom-container {
				border-top: 1px solid var(--border-color);
				height: 3rem;
				display: flex;
				justify-content: space-between;
				align-items: center;
				padding: 0 1rem;

				@media (max-width: 768px) {
					.email {
						display: none;
					}
				}
			}
		}
	}
</style>
